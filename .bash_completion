_complete_basename() {
  local basename_to_complete=${COMP_WORDS[COMP_CWORD]}
  local basenames=()

  if [[ $PWD != "/" ]]; then
    basenames+=("/\n")

    while read -d "/"; do
      basenames+=("$REPLY\n")
    done <<< "${PWD:1}"
  fi

  local IFS=$'\n'
  COMPREPLY=($(compgen -W "$(printf "%s\n" "${basenames[@]}")" -- "${COMP_WORDS[COMP_CWORD]}"))
}

complete -F _complete_basename up
